<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Aliquot Sequence Research: pomyang_kparent/src/pomyang_kparent.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Aliquot Sequence Research
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Compute properties of the sum-of-proper-divisors function.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9f4a420dda9f9457760cfca95ea7641c.html">pomyang_kparent</a></li><li class="navelem"><a class="el" href="dir_05bd5b20feac2949e2e37b7079d1a622.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pomyang_kparent.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Counts the even numbers with k-preimages under the sum-of-proper-divisors function.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pomyang__kparent_8h_source.html">../inc/pomyang_kparent.h</a>&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;alloca.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &quot;<a class="el" href="moewsmoews__sieve_8h_source.html">../inc/moewsmoews_sieve.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="math__macros_8h_source.html">../inc/math_macros.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pomyang_kparent.c:</div>
<div class="dyncontent">
<div class="center"><img src="pomyang__kparent_8c__incl.png" border="0" usemap="#pomyang__kparent_2src_2pomyang__kparent_8c" alt=""/></div>
<map name="pomyang__kparent_2src_2pomyang__kparent_8c" id="pomyang__kparent_2src_2pomyang__kparent_8c">
<area shape="rect" title="Counts the even numbers with k&#45;preimages under the sum&#45;of&#45;proper&#45;divisors function." alt="" coords="806,5,969,47"/>
<area shape="rect" href="pomyang__kparent_8h.html" title="api for pom_yang algorithm operations" alt="" coords="329,95,515,121"/>
<area shape="rect" title=" " alt="" coords="521,244,584,271"/>
<area shape="rect" href="math__macros_8h.html" title=" " alt="" coords="520,169,679,196"/>
<area shape="rect" title=" " alt="" coords="754,95,829,121"/>
<area shape="rect" title=" " alt="" coords="853,95,921,121"/>
<area shape="rect" title=" " alt="" coords="946,95,1013,121"/>
<area shape="rect" title=" " alt="" coords="1037,95,1111,121"/>
<area shape="rect" title=" " alt="" coords="1136,95,1207,121"/>
<area shape="rect" title=" " alt="" coords="1231,95,1304,121"/>
<area shape="rect" title=" " alt="" coords="1329,95,1393,121"/>
<area shape="rect" href="moewsmoews__sieve_8h.html" title="api to the Moews and Moews sieving algorithm" alt="" coords="79,95,285,121"/>
<area shape="rect" title=" " alt="" coords="242,169,325,196"/>
<area shape="rect" title=" " alt="" coords="147,169,217,196"/>
<area shape="rect" href="PackedArray_8h_source.html" title=" " alt="" coords="349,169,495,196"/>
<area shape="rect" title=" " alt="" coords="256,244,327,271"/>
<area shape="rect" title=" " alt="" coords="26,169,122,196"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aedc8a284461fd96961d1637cc53b3d4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structPackedArray.html">PackedArray</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomyang__kparent_8c.html#aedc8a284461fd96961d1637cc53b3d4f">pomyang_algorithm</a> (const <a class="el" href="structpomyang__config__t.html">pomyang_config_t</a> *cfg)</td></tr>
<tr class="memdesc:aedc8a284461fd96961d1637cc53b3d4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the Pomerance-Yang algorithm.  <a href="pomyang__kparent_8c.html#aedc8a284461fd96961d1637cc53b3d4f">More...</a><br /></td></tr>
<tr class="separator:aedc8a284461fd96961d1637cc53b3d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c6cfb8c6b83213ffe1574167941734"><td class="memItemLeft" align="right" valign="top">uint64_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomyang__kparent_8c.html#a82c6cfb8c6b83213ffe1574167941734">pomyang_count_kparent</a> (const <a class="el" href="structpomyang__config__t.html">pomyang_config_t</a> *cfg)</td></tr>
<tr class="memdesc:a82c6cfb8c6b83213ffe1574167941734"><td class="mdescLeft">&#160;</td><td class="mdescRight">runs the Pomerance-Yang algorithm and counts occurrence of kparent numbers.  <a href="pomyang__kparent_8c.html#a82c6cfb8c6b83213ffe1574167941734">More...</a><br /></td></tr>
<tr class="separator:a82c6cfb8c6b83213ffe1574167941734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ca0408d4ff70008efc59acd3f2c4f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pomyang__kparent_8c.html#a28ca0408d4ff70008efc59acd3f2c4f5">print_to_file</a> (<a class="el" href="structpomyang__config__t.html">pomyang_config_t</a> *cfg, const char *filename, uint64_t *count, float runtime)</td></tr>
<tr class="memdesc:a28ca0408d4ff70008efc59acd3f2c4f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints Pomerance-Yang algorithm configuration.  <a href="pomyang__kparent_8c.html#a28ca0408d4ff70008efc59acd3f2c4f5">More...</a><br /></td></tr>
<tr class="separator:a28ca0408d4ff70008efc59acd3f2c4f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Counts the even numbers with k-preimages under the sum-of-proper-divisors function. </p>
<dl class="section author"><dt>Author</dt><dd>Gavin Guinn (<a href="#" onclick="location.href='mai'+'lto:'+'gav'+'in'+'gui'+'nn'+'1@g'+'ma'+'il.'+'co'+'m'; return false;">gavin<span style="display: none;">.nosp@m.</span>guin<span style="display: none;">.nosp@m.</span>n1@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-2-17</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Public Domain (Please credit me; if you find this code useful I would love to hear about your work!)</dd></dl>
<h2><a class="anchor" id="autotoc_md8"></a>
NOTE</h2>
<p><b>The counts of non-aliquots reported by this program will be exactly one less than the published figures!</b> This algorithm enumerates all <em>even</em> k-parent numbers, odd k-parent numbers exist but they are not considered. The user is expected to adjust the count to consider <em>5</em> which is the only odd aliquot (see sect. 3, [Chum et al.]). It may seem odd to only count even k-parent numbers while odd k-parents also exist, this program must be seen in the context of using heuristics to approach the Guy-Selfridge conjecture, see [Guy and Selfridge] and [Chum et al.] for details.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
ALGORITHMS</h2>
<p>This is a rewrite of Anton Mosunov's implementation of the tabulation of untouchable numbers, section 3 of [Chum et al.]. As described in the paper this program is capable of counting of aliquot untouchables and more generally counting numbers with k preimages under the sum-of-proper-divisors (<code>sumdiv</code> / <code>s(n)</code>) function, these numbers are referred to as k-parent. The algorithm employed in [Chum et al.] was originally developed in a paper of [Pomerance and Yang] where the author's describe a family of algorithms for enumerating preimages, the algorithm for s(n) will be referred to as the Pomerance-Yang (<code>pomyang</code>) algorithm. The <code>pomyang</code> algorithm takes the sum-of-divisors (sigma) for all odd numbers in the range (1, <code>bound</code>) as input, to produce these values a technique of [Moews and Moews] for sieving ranges of sigma is used to efficiently generate these values.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
TECHNIQUE</h2>
<p>The techniques used in this implementation broadly differ from those described in [Chum et al.], notably no disc operations are used. The sum-of-divisors (sigma) for all odd numbers in the range (1, <code>bound</code>) are sieved on-the-fly rather than ^pre-computed and stored. A buffer is required to hold the counts of preimages for all even numbers less than <code>bound</code>, this can require huge amounts of memory (using 8 bit counter takes <code>~500gb</code> at <code>bound</code> of 2^40). When enumerating non-aliquots only 1-bit per number is required, however <code>sizeof(bool) == sizeof(uint8_t)</code> as a byte is the smallest addressable unit of memory. A <a class="el" href="structPackedArray.html" title="PackedArray handle.">PackedArray</a> data structure is used to create a buffer that can store 1, 2, or 4 bits of information in exactly that much memory, vasty decreasing memory requirements. Threads must share this buffer when running the otherwise embarrassingly parallel pomyang algorithm, this is accomplished by allocating an array of locks to protect portions of the resource. Locking the entire buffer whenever a thread wants to record a image bottlenecks the whole process.</p>
<p>^ [Chum et al.] indicates only sieving odd sigma upto <code>bound</code> / 2 but odd sigma upto <code>bound</code> is certainly a required input for the Pomerance-Yang algorithm</p>
<h2><a class="anchor" id="autotoc_md11"></a>
PERFORMANCE</h2>
<p>The parameter num_locks should be set to the highest value possible given memory constraits to optimize for speed. The parameter seg_len has a far more ambiguous effect on performance, if set either to low or high it can seriously impact performance see moews_moews_sieve.c for a more detailed analysis.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
CITATIONS</h2>
<ul>
<li>[Chum et al.] Chum, K., Guy, R. K., Jacobson, J. M. J., and Mosunov, A. S. (2018). Numerical and statistical analysis of aliquot sequences. Experimental Mathematics, 29(4):414–425.</li>
<li>[Pomerance and Yang] Pomerance, C. and Yang, H.-S. (2014). Variant of a theorem of Erdos on the sum-of-proper-divisors function. Mathematics of Computation, 83(288):1903–1913.</li>
<li>[Moews and Moews] Moews, D. and Moews, P. C. (1991). A search for aliquot cycles below 10 10. Mathematics of Computation, 57(196):849.</li>
<li>[Guy and Selfridge] Guy, R. K. and Selfridge, J. L. (1975). What drives an aliquot sequence? Mathematics of Computation, 29(129):101–101.</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
NOTATION</h2>
<ul>
<li>sumdiv / s(n) == sum-of-proper-divisors</li>
<li>sigma == sum-of-divisors</li>
<li>kparent == number with k preimages under s(n) </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aedc8a284461fd96961d1637cc53b3d4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedc8a284461fd96961d1637cc53b3d4f">&#9670;&nbsp;</a></span>pomyang_algorithm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structPackedArray.html">PackedArray</a>* pomyang_algorithm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structpomyang__config__t.html">pomyang_config_t</a> *&#160;</td>
          <td class="paramname"><em>cfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the Pomerance-Yang algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cfg</td><td>See struct defintion </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PackedArray* containing the number of preimages for even number upto bound. Free'd by caller. </dd></dl>

</div>
</div>
<a id="a82c6cfb8c6b83213ffe1574167941734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82c6cfb8c6b83213ffe1574167941734">&#9670;&nbsp;</a></span>pomyang_count_kparent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t* pomyang_count_kparent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structpomyang__config__t.html">pomyang_config_t</a> *&#160;</td>
          <td class="paramname"><em>cfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>runs the Pomerance-Yang algorithm and counts occurrence of kparent numbers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cfg</td><td>See struct definition </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint64_t* buffer of length (UINT8_MAX + 1) with occurrence counts, must be free'd by caller </dd></dl>

</div>
</div>
<a id="a28ca0408d4ff70008efc59acd3f2c4f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ca0408d4ff70008efc59acd3f2c4f5">&#9670;&nbsp;</a></span>print_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_to_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpomyang__config__t.html">pomyang_config_t</a> *&#160;</td>
          <td class="paramname"><em>cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>runtime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints Pomerance-Yang algorithm configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cfg</td><td>Pointer to config struct. </td></tr>
    <tr><td class="paramname">filename</td><td>Name of file to write. </td></tr>
    <tr><td class="paramname">count</td><td>Array of k-parent counts. </td></tr>
    <tr><td class="paramname">runtime</td><td>CPU seconds used. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
