\hypertarget{pomyang__kparent_8c}{}\doxysubsection{pomyang\+\_\+kparent/src/pomyang\+\_\+kparent.c File Reference}
\label{pomyang__kparent_8c}\index{pomyang\_kparent/src/pomyang\_kparent.c@{pomyang\_kparent/src/pomyang\_kparent.c}}


Counts the even numbers with k-\/preimages under the sum-\/of-\/proper-\/divisors function.  


{\ttfamily \#include \char`\"{}../inc/pomyang\+\_\+kparent.\+h\char`\"{}}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$omp.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$alloca.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../inc/moewsmoews\+\_\+sieve.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../inc/math\+\_\+macros.\+h\char`\"{}}\newline
Include dependency graph for pomyang\+\_\+kparent.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{pomyang__kparent_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structPackedArray}{Packed\+Array}} $\ast$ \mbox{\hyperlink{pomyang__kparent_8c_aedc8a284461fd96961d1637cc53b3d4f}{pomyang\+\_\+algorithm}} (const \mbox{\hyperlink{structpomyang__config__t}{pomyang\+\_\+config\+\_\+t}} $\ast$cfg)
\begin{DoxyCompactList}\small\item\em Runs the Pomerance-\/\+Yang algorithm. \end{DoxyCompactList}\item 
uint64\+\_\+t $\ast$ \mbox{\hyperlink{pomyang__kparent_8c_a82c6cfb8c6b83213ffe1574167941734}{pomyang\+\_\+count\+\_\+kparent}} (const \mbox{\hyperlink{structpomyang__config__t}{pomyang\+\_\+config\+\_\+t}} $\ast$cfg)
\begin{DoxyCompactList}\small\item\em runs the Pomerance-\/\+Yang algorithm and counts occurrence of kparent numbers. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{pomyang__kparent_8c_a28ca0408d4ff70008efc59acd3f2c4f5}{print\+\_\+to\+\_\+file}} (\mbox{\hyperlink{structpomyang__config__t}{pomyang\+\_\+config\+\_\+t}} $\ast$cfg, const char $\ast$filename, uint64\+\_\+t $\ast$count, float runtime)
\begin{DoxyCompactList}\small\item\em Prints Pomerance-\/\+Yang algorithm configuration. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Counts the even numbers with k-\/preimages under the sum-\/of-\/proper-\/divisors function. 

\begin{DoxyAuthor}{Author}
Gavin Guinn (\href{mailto:gavinguinn1@gmail.com}{\texttt{ gavinguinn1@gmail.\+com}}) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2021-\/2-\/17
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Public Domain (Please credit me; if you find this code useful I would love to hear about your work!)
\end{DoxyCopyright}
\hypertarget{pomyang__kparent_8c_autotoc_md8}{}\doxyparagraph{N\+O\+TE}\label{pomyang__kparent_8c_autotoc_md8}
{\bfseries{The counts of non-\/aliquots reported by this program will be exactly one less than the published figures!}} This algorithm enumerates all {\itshape even} k-\/parent numbers, odd k-\/parent numbers exist but they are not considered. The user is expected to adjust the count to consider {\itshape 5} which is the only odd aliquot (see sect. 3, \mbox{[}Chum et al.\mbox{]}). It may seem odd to only count even k-\/parent numbers while odd k-\/parents also exist, this program must be seen in the context of using heuristics to approach the Guy-\/\+Selfridge conjecture, see \mbox{[}Guy and Selfridge\mbox{]} and \mbox{[}Chum et al.\mbox{]} for details.\hypertarget{pomyang__kparent_8c_autotoc_md9}{}\doxyparagraph{A\+L\+G\+O\+R\+I\+T\+H\+MS}\label{pomyang__kparent_8c_autotoc_md9}
This is a rewrite of Anton Mosunov\textquotesingle{}s implementation of the tabulation of untouchable numbers, section 3 of \mbox{[}Chum et al.\mbox{]}. As described in the paper this program is capable of counting of aliquot untouchables and more generally counting numbers with k preimages under the sum-\/of-\/proper-\/divisors ({\ttfamily sumdiv} / {\ttfamily s(n)}) function, these numbers are referred to as k-\/parent. The algorithm employed in \mbox{[}Chum et al.\mbox{]} was originally developed in a paper of \mbox{[}Pomerance and Yang\mbox{]} where the author\textquotesingle{}s describe a family of algorithms for enumerating preimages, the algorithm for s(n) will be referred to as the Pomerance-\/\+Yang ({\ttfamily pomyang}) algorithm. The {\ttfamily pomyang} algorithm takes the sum-\/of-\/divisors (sigma) for all odd numbers in the range (1, {\ttfamily bound}) as input, to produce these values a technique of \mbox{[}Moews and Moews\mbox{]} for sieving ranges of sigma is used to efficiently generate these values.\hypertarget{pomyang__kparent_8c_autotoc_md10}{}\doxyparagraph{T\+E\+C\+H\+N\+I\+Q\+UE}\label{pomyang__kparent_8c_autotoc_md10}
The techniques used in this implementation broadly differ from those described in \mbox{[}Chum et al.\mbox{]}, notably no disc operations are used. The sum-\/of-\/divisors (sigma) for all odd numbers in the range (1, {\ttfamily bound}) are sieved on-\/the-\/fly rather than $^\wedge$pre-\/computed and stored. A buffer is required to hold the counts of preimages for all even numbers less than {\ttfamily bound}, this can require huge amounts of memory (using 8 bit counter takes {\ttfamily $\sim$500gb} at {\ttfamily bound} of 2$^\wedge$40). When enumerating non-\/aliquots only 1-\/bit per number is required, however {\ttfamily sizeof(bool) == sizeof(uint8\+\_\+t)} as a byte is the smallest addressable unit of memory. A \mbox{\hyperlink{structPackedArray}{Packed\+Array}} data structure is used to create a buffer that can store 1, 2, or 4 bits of information in exactly that much memory, vasty decreasing memory requirements. Threads must share this buffer when running the otherwise embarrassingly parallel pomyang algorithm, this is accomplished by allocating an array of locks to protect portions of the resource. Locking the entire buffer whenever a thread wants to record a image bottlenecks the whole process.

$^\wedge$ \mbox{[}Chum et al.\mbox{]} indicates only sieving odd sigma upto {\ttfamily bound} / 2 but odd sigma upto {\ttfamily bound} is certainly a required input for the Pomerance-\/\+Yang algorithm\hypertarget{pomyang__kparent_8c_autotoc_md11}{}\doxyparagraph{P\+E\+R\+F\+O\+R\+M\+A\+N\+CE}\label{pomyang__kparent_8c_autotoc_md11}
The parameter num\+\_\+locks should be set to the highest value possible given memory constraits to optimize for speed. The parameter seg\+\_\+len has a far more ambiguous effect on performance, if set either to low or high it can seriously impact performance see moews\+\_\+moews\+\_\+sieve.\+c for a more detailed analysis.\hypertarget{pomyang__kparent_8c_autotoc_md12}{}\doxyparagraph{C\+I\+T\+A\+T\+I\+O\+NS}\label{pomyang__kparent_8c_autotoc_md12}

\begin{DoxyItemize}
\item \mbox{[}Chum et al.\mbox{]} Chum, K., Guy, R. K., Jacobson, J. M. J., and Mosunov, A. S. (2018). Numerical and statistical analysis of aliquot sequences. Experimental Mathematics, 29(4)\+:414–425.
\item \mbox{[}Pomerance and Yang\mbox{]} Pomerance, C. and Yang, H.-\/S. (2014). Variant of a theorem of Erdos on the sum-\/of-\/proper-\/divisors function. Mathematics of Computation, 83(288)\+:1903–1913.
\item \mbox{[}Moews and Moews\mbox{]} Moews, D. and Moews, P. C. (1991). A search for aliquot cycles below 10 10. Mathematics of Computation, 57(196)\+:849.
\item \mbox{[}Guy and Selfridge\mbox{]} Guy, R. K. and Selfridge, J. L. (1975). What drives an aliquot sequence? Mathematics of Computation, 29(129)\+:101–101.
\end{DoxyItemize}\hypertarget{pomyang__kparent_8c_autotoc_md13}{}\doxyparagraph{N\+O\+T\+A\+T\+I\+ON}\label{pomyang__kparent_8c_autotoc_md13}

\begin{DoxyItemize}
\item sumdiv / s(n) == sum-\/of-\/proper-\/divisors
\item sigma == sum-\/of-\/divisors
\item kparent == number with k preimages under s(n) 
\end{DoxyItemize}

\doxysubsubsection{Function Documentation}
\mbox{\Hypertarget{pomyang__kparent_8c_aedc8a284461fd96961d1637cc53b3d4f}\label{pomyang__kparent_8c_aedc8a284461fd96961d1637cc53b3d4f}} 
\index{pomyang\_kparent.c@{pomyang\_kparent.c}!pomyang\_algorithm@{pomyang\_algorithm}}
\index{pomyang\_algorithm@{pomyang\_algorithm}!pomyang\_kparent.c@{pomyang\_kparent.c}}
\doxyparagraph{\texorpdfstring{pomyang\_algorithm()}{pomyang\_algorithm()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structPackedArray}{Packed\+Array}}$\ast$ pomyang\+\_\+algorithm (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structpomyang__config__t}{pomyang\+\_\+config\+\_\+t}} $\ast$}]{cfg }\end{DoxyParamCaption})}



Runs the Pomerance-\/\+Yang algorithm. 


\begin{DoxyParams}{Parameters}
{\em cfg} & See struct defintion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Packed\+Array$\ast$ containing the number of preimages for even number upto bound. Free\textquotesingle{}d by caller. 
\end{DoxyReturn}
\mbox{\Hypertarget{pomyang__kparent_8c_a82c6cfb8c6b83213ffe1574167941734}\label{pomyang__kparent_8c_a82c6cfb8c6b83213ffe1574167941734}} 
\index{pomyang\_kparent.c@{pomyang\_kparent.c}!pomyang\_count\_kparent@{pomyang\_count\_kparent}}
\index{pomyang\_count\_kparent@{pomyang\_count\_kparent}!pomyang\_kparent.c@{pomyang\_kparent.c}}
\doxyparagraph{\texorpdfstring{pomyang\_count\_kparent()}{pomyang\_count\_kparent()}}
{\footnotesize\ttfamily uint64\+\_\+t$\ast$ pomyang\+\_\+count\+\_\+kparent (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structpomyang__config__t}{pomyang\+\_\+config\+\_\+t}} $\ast$}]{cfg }\end{DoxyParamCaption})}



runs the Pomerance-\/\+Yang algorithm and counts occurrence of kparent numbers. 


\begin{DoxyParams}{Parameters}
{\em cfg} & See struct definition \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint64\+\_\+t$\ast$ buffer of length (U\+I\+N\+T8\+\_\+\+M\+AX + 1) with occurrence counts, must be free\textquotesingle{}d by caller 
\end{DoxyReturn}
\mbox{\Hypertarget{pomyang__kparent_8c_a28ca0408d4ff70008efc59acd3f2c4f5}\label{pomyang__kparent_8c_a28ca0408d4ff70008efc59acd3f2c4f5}} 
\index{pomyang\_kparent.c@{pomyang\_kparent.c}!print\_to\_file@{print\_to\_file}}
\index{print\_to\_file@{print\_to\_file}!pomyang\_kparent.c@{pomyang\_kparent.c}}
\doxyparagraph{\texorpdfstring{print\_to\_file()}{print\_to\_file()}}
{\footnotesize\ttfamily void print\+\_\+to\+\_\+file (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structpomyang__config__t}{pomyang\+\_\+config\+\_\+t}} $\ast$}]{cfg,  }\item[{const char $\ast$}]{filename,  }\item[{uint64\+\_\+t $\ast$}]{count,  }\item[{float}]{runtime }\end{DoxyParamCaption})}



Prints Pomerance-\/\+Yang algorithm configuration. 


\begin{DoxyParams}{Parameters}
{\em cfg} & Pointer to config struct. \\
\hline
{\em filename} & Name of file to write. \\
\hline
{\em count} & Array of k-\/parent counts. \\
\hline
{\em runtime} & C\+PU seconds used. \\
\hline
\end{DoxyParams}
